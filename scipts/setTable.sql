drop table emp;
drop table office;
drop table dept;
drop table jobs;
drop sequence counter;
create table emp (
	ID  NUMBER PRIMARY KEY,
	FIRSTNAME VARCHAR2(50),
	LASTNAME VARCHAR2(50),
	MGRID NUMBER,
	DEPARTMENT_ID NUMBER,
	JOB_ID NUMBER,
	OFFICE_ID NUMBER,
	SALEGRADE NUMBER
);
CREATE TABLE OFFICE (
	ID NUMBER PRIMARY KEY,
	TITLE VARCHAR2(100),
	ADDRESS VARCHAR2(1000),
	MANAGER NUMBER
);
CREATE TABLE JOBS (
	ID NUMBER PRIMARY KEY,
	TITLE VARCHAR2(300),
	DESCRIPTION VARCHAR2(1000)
);
CREATE TABLE DEPT (
	ID NUMBER PRIMARY KEY,
	TITLE VARCHAR2(300),
	DESCRIPTION VARCHAR2(1000)
);
ALTER TABLE EMP ADD CONSTRAINT ID_JOB FOREIGN KEY(JOB_ID) REFERENCES JOBS(ID);
ALTER TABLE EMP ADD CONSTRAINT ID_DEP FOREIGN KEY(DEPARTMENT_ID) REFERENCES DEPT(ID);
ALTER TABLE EMP ADD CONSTRAINT ID_LOC FOREIGN KEY(OFFICE_ID) REFERENCES OFFICE(ID);

CREATE SEQUENCE COUNTER 
  MINVALUE 1
  MAXVALUE 9999
  START WITH 1
  INCREMENT BY 1
  CYCLE;
--SELECT TO_CHAR(COUNTER.NEXTVAL,'0000') FROM DUAL;
--SELECT TO_CHAR(SYSDATE,'yyyymmddSSSS') FROM dual;

CREATE OR REPLACE FUNCTION fun RETURN VARCHAR2 is
  IDCHAR VARCHAR2(17);
BEGIN 
  SELECT TO_CHAR(SYSDATE,'yyyymmddSSSS')||trim(TO_CHAR(COUNTER.NEXTVAL,'0000')) into IDCHAR FROM dual;
  RETURN IDCHAR;
END fun;
/
SHOW ERROR
--begin 
--dbms_output.put_line(fun());
--end;
--/
--CREATE OR REPLACE FUNCTION fun RETURN VARCHAR2 is
--IDCHAR VARCHAR2(5);
--BEGIN 
--  SELECT TO_CHAR(COUNTER.NEXTVAL,'0000') into IDCHAR FROM DUAL;
--  RETURN IDCHAR;
--END fun;
--/